package gotezos

import (
	"net/http"
	"regexp"
)

var mockBlockRandom = []byte(`{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"BLzGD63HA4RP8Fh5xEtvdQSMKa2WzJMZjQPNVUc4Rqy8Lh5BEY1","header":{"level":656939,"proto":5,"predecessor":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","timestamp":"2019-10-19T13:44:41Z","validation_pass":4,"operations_hash":"LLoaTVCGSnVwnzcSSLQevLieJJ5zmRLCFzRHsd2ZohF6FT8qdB3PD","fitness":["01","000000000000062b"],"context":"CoVVyoEZA2y25w1C51K6FgdkEKNuyWTmQXfUtb2C4XnzXtVhxVjM","priority":0,"proof_of_work_nonce":"756e6b6feb131fdb","signature":"siggkJPySMihG93d6WYXpsu1Jar1xYQLTuhQ1iVrmFDCBfGc6thnsCxgoyb6ZqqabpZ5jcoYvug6YZwG5Gjo4j5K1TsV3cqp"},"metadata":{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","next_protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","test_chain_status":{"status":"not_running"},"max_operations_ttl":60,"max_operation_data_length":16384,"max_block_header_length":238,"max_operation_list_length":[{"max_size":32768,"max_op":32},{"max_size":32768},{"max_size":135168,"max_op":132},{"max_size":524288}],"baker":"tz3WMqdzXqRWXwyvj5Hp2H7QEepaUuS7vd9K","level":{"level":656939,"level_position":656938,"cycle":160,"cycle_position":1578,"voting_period":20,"voting_period_position":1578,"expected_commitment":false},"voting_period_kind":"proposal","nonce_hash":null,"consumed_gas":"25492","deactivated":[],"balance_updates":[{"kind":"contract","contract":"tz3WMqdzXqRWXwyvj5Hp2H7QEepaUuS7vd9K","change":"-512000000"},{"kind":"freezer","category":"deposits","delegate":"tz3WMqdzXqRWXwyvj5Hp2H7QEepaUuS7vd9K","cycle":160,"change":"512000000"},{"kind":"freezer","category":"rewards","delegate":"tz3WMqdzXqRWXwyvj5Hp2H7QEepaUuS7vd9K","cycle":160,"change":"16000000"}]},"operations":[[{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"opX4UniMfWCHYn7w1buBPxK4yGCpPFssQE3VzBRf4sFCzBHxLuw","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1Kt4P8BCaP93AEV4eA7gmpRryWt5hznjCP","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1Kt4P8BCaP93AEV4eA7gmpRryWt5hznjCP","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1Kt4P8BCaP93AEV4eA7gmpRryWt5hznjCP","cycle":160,"change":"2000000"}],"delegate":"tz1Kt4P8BCaP93AEV4eA7gmpRryWt5hznjCP","slots":[15]}}],"signature":"sigvU29YNjSN8foVQRgqBYWS1wsqSGmWtnE6WrTiq9zfMxAnyrq7zJdPGVQiLUTTmqEzDjjRKRsdRnDbsnXUgc1afnqRApru"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"onrJzin1urvfgNAsSZ9t7QsWvuKwDqqamKA6suy6d44CHjxK1KZ","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1P2Po7YM526ughEsRbY4oR9zaUPDZjxFrb","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1P2Po7YM526ughEsRbY4oR9zaUPDZjxFrb","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1P2Po7YM526ughEsRbY4oR9zaUPDZjxFrb","cycle":160,"change":"2000000"}],"delegate":"tz1P2Po7YM526ughEsRbY4oR9zaUPDZjxFrb","slots":[7]}}],"signature":"sigW7M2tPzGMcxLxHsniGJfEKWSrzF3MYzuFcDagwNNa2sYVqoncn6RsgUpKfJzzULFnPB9ux79o9A3UqhvQrMU3Uco7n7K1"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"opGi3dj16BQ5CdKonchZz5c2Pew2b1EGMTbc6XS3SdFgTx6JydP","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1LcuQHNVQEWP2fZjk1QYZGNrfLDwrT3SyZ","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1LcuQHNVQEWP2fZjk1QYZGNrfLDwrT3SyZ","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1LcuQHNVQEWP2fZjk1QYZGNrfLDwrT3SyZ","cycle":160,"change":"2000000"}],"delegate":"tz1LcuQHNVQEWP2fZjk1QYZGNrfLDwrT3SyZ","slots":[30]}}],"signature":"sigWUx3qYo6NZJkt1pRUKUTfmZUArU21xHcSgeu1ttBjgPyqJzhDry3EPYbVmxoKCg5LfB9cwH6BkTsSzT5YovarYSVsVN98"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"opR16Jxv3MLo8FeayHsr12mRjPAh8HepmSrNRH9Asv1mJHyAQXA","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1WBfwbT66FC6BTLexc2BoyCCBM9LG7pnVW","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1WBfwbT66FC6BTLexc2BoyCCBM9LG7pnVW","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1WBfwbT66FC6BTLexc2BoyCCBM9LG7pnVW","cycle":160,"change":"2000000"}],"delegate":"tz1WBfwbT66FC6BTLexc2BoyCCBM9LG7pnVW","slots":[31]}}],"signature":"sigkjQYN8boBH1fqFzEkRpp8DVtdF3q1XiUjXwauWMdaBQpaCQFajqsSDNpNxoJUzL4bXpi98xQkDq6v1FQYSVsb7y7C5d3y"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"op63EzCuyNgEbRYrCyaBYpxe4XDbMUMDy21JK5sFpZX66NCb4hR","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1Xsrfv6hn86fp88YfRs6xcKwt2nTqxVZYM","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1Xsrfv6hn86fp88YfRs6xcKwt2nTqxVZYM","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1Xsrfv6hn86fp88YfRs6xcKwt2nTqxVZYM","cycle":160,"change":"2000000"}],"delegate":"tz1Xsrfv6hn86fp88YfRs6xcKwt2nTqxVZYM","slots":[0]}}],"signature":"sigh3GuwNbR1gfJ5kkm8UUjq75io5w7n3tsBBSFyFk7kMUSrSSMgWLqhuERJdmRuuArS8QL8suwqFMX9fFkdtpakXTvnQoBL"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"op3H6PbKiH7znSasRjvHPYFcUU5N1KKdtmhWDN5j1eqTamBSwCw","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz3VEZ4k6a4Wx42iyev6i2aVAptTRLEAivNN","change":"-128000000"},{"kind":"freezer","category":"deposits","delegate":"tz3VEZ4k6a4Wx42iyev6i2aVAptTRLEAivNN","cycle":160,"change":"128000000"},{"kind":"freezer","category":"rewards","delegate":"tz3VEZ4k6a4Wx42iyev6i2aVAptTRLEAivNN","cycle":160,"change":"4000000"}],"delegate":"tz3VEZ4k6a4Wx42iyev6i2aVAptTRLEAivNN","slots":[10,5]}}],"signature":"sigo1iC2uiczSDbyDSBAGFvibtzmE3PanroBM8pgytkvCkuJScWNNkgHXJ1YWUbMGkBy1L86TdhfrpAaPiYFGZFKVxp893cg"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"onzDm5EDfWbio5M9sg29yQ2PfZvfe1YiuFqjjEDjELf9aMccCfA","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1WctSwL49BZtdWAQ75NY6vr4xsAx6oKdah","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1WctSwL49BZtdWAQ75NY6vr4xsAx6oKdah","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1WctSwL49BZtdWAQ75NY6vr4xsAx6oKdah","cycle":160,"change":"2000000"}],"delegate":"tz1WctSwL49BZtdWAQ75NY6vr4xsAx6oKdah","slots":[18]}}],"signature":"sigqBkdYf12g81rdyu1CEhJGd4rRkKpq72TU5v9GAacoj7s4NoUX85yJzFgcw2HPafuqr7ukVc8fJ7unjLzEChTbREg3Jwpv"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"opQCWzmFvREnBg96e5tdbrNV1znUU8uvUH63dWzLChKnTWSnTmc","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz3bvNMQ95vfAYtG8193ymshqjSvmxiCUuR5","change":"-192000000"},{"kind":"freezer","category":"deposits","delegate":"tz3bvNMQ95vfAYtG8193ymshqjSvmxiCUuR5","cycle":160,"change":"192000000"},{"kind":"freezer","category":"rewards","delegate":"tz3bvNMQ95vfAYtG8193ymshqjSvmxiCUuR5","cycle":160,"change":"6000000"}],"delegate":"tz3bvNMQ95vfAYtG8193ymshqjSvmxiCUuR5","slots":[25,9,4]}}],"signature":"sigZnANU2ykmheh9QJKK8jnVACfbVUsA4zYsn1jjfquRUv9vJWRSszUwdEQxaMyRJN2zEGtuuUVXcaeTEnVP1x3zejU5rrrM"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"onw3fUAz2nBRgLRchrZuoV4uEr7hVzixSMxMNfVed8DPncQ2F1u","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1NpWrAyDL9k2Lmnyxcgr9xuJakbBxdq7FB","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1NpWrAyDL9k2Lmnyxcgr9xuJakbBxdq7FB","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1NpWrAyDL9k2Lmnyxcgr9xuJakbBxdq7FB","cycle":160,"change":"2000000"}],"delegate":"tz1NpWrAyDL9k2Lmnyxcgr9xuJakbBxdq7FB","slots":[14]}}],"signature":"sigfH8WBcnQouthw9Tigb9Qb1qhqkP41n3E1pnx4fBGy5eMfTzi2wVPvrrqJmaG2WFbf4QPGhBF6D4pK8MJh7VEXHDVNS15H"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"ooHKFhhYfbppHpV9LbQNMW76zLG8PfNF3HVk7q2HSrFPtw9GdbB","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1isXamBXpTUgbByQ6gXgZQg4GWNW7r6rKE","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1isXamBXpTUgbByQ6gXgZQg4GWNW7r6rKE","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1isXamBXpTUgbByQ6gXgZQg4GWNW7r6rKE","cycle":160,"change":"2000000"}],"delegate":"tz1isXamBXpTUgbByQ6gXgZQg4GWNW7r6rKE","slots":[20]}}],"signature":"sigmZ3S4yKAyNFyKhRQfsCLnFKf6LuyNqda1cfX999eb2ec2fWbJRUppCLUtMSNNY9cXbt1d7hYhzcHtnMNeaKY6E8gfknA3"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"op5jaXUVbNnBbZvDeffBew7R7Wk64o1z3DDmZsm5eUCUGxqBVLq","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1ZNWFe3LmEJYTydctcgD6a5Apemwdtimn4","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1ZNWFe3LmEJYTydctcgD6a5Apemwdtimn4","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1ZNWFe3LmEJYTydctcgD6a5Apemwdtimn4","cycle":160,"change":"2000000"}],"delegate":"tz1ZNWFe3LmEJYTydctcgD6a5Apemwdtimn4","slots":[12]}}],"signature":"sigdSpxyGzgBzJwjCNMwc7eB7wR2yCg2T4bqFCALxNoHMbwk2BuzZpkcT9oB9uyryFp8D98z1N8Zuiuf2QsDWJYRhQ9UGt4V"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"ooAD9LiA6B2WkPL1TerMKmE9yRS88iLJ6aLu36KYeW7AiMWeFLo","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1cYufsxHXJcvANhvS55h3aY32a9BAFB494","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1cYufsxHXJcvANhvS55h3aY32a9BAFB494","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1cYufsxHXJcvANhvS55h3aY32a9BAFB494","cycle":160,"change":"2000000"}],"delegate":"tz1cYufsxHXJcvANhvS55h3aY32a9BAFB494","slots":[29]}}],"signature":"sigq6vqRXBGtNxAKGXDebkKuAiZ32AuubdFfWYxWVC7rcQZLXdHF77CYh1pWe9a6T9tYJScunPLLcBXPrSa9Ci1g2RDhhquz"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"oo4MbTFvuRbmuuoDk2PhgDSDosnWWh7TTvdMgKFtE9C4VGLXzA1","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1TzaNn7wSQSP5gYPXCnNzBCpyMiidCq1PX","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1TzaNn7wSQSP5gYPXCnNzBCpyMiidCq1PX","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1TzaNn7wSQSP5gYPXCnNzBCpyMiidCq1PX","cycle":160,"change":"2000000"}],"delegate":"tz1TzaNn7wSQSP5gYPXCnNzBCpyMiidCq1PX","slots":[28]}}],"signature":"sigT352d7euTLAd86hmYkoKtiYGiwztnBjGXagJ57VAvkMWrWdLMsr2Xf7XTB9UxiHGL8kAEqi5DsE9GAQybHapeSdk9P71f"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"onnM23y3xTP44JERUxGjb7L9NysSAu4F3TUMDxMCLHC3PQW76sD","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1WCd2jm4uSt4vntk4vSuUWoZQGhLcDuR9q","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1WCd2jm4uSt4vntk4vSuUWoZQGhLcDuR9q","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1WCd2jm4uSt4vntk4vSuUWoZQGhLcDuR9q","cycle":160,"change":"2000000"}],"delegate":"tz1WCd2jm4uSt4vntk4vSuUWoZQGhLcDuR9q","slots":[22]}}],"signature":"sigjzk2mwPj3ehguWfo91L9bRNk6GYaXpvGpmamdZVAHemyJNnTSh5akZmfHTSTsBtKhnvo6VmpvpXUTAzA47d3UppsrESuh"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"ooPNNa1EqP4XAoeE4YSXtxkXeR5kwrd3vk9mEGXhrxMBohJBXab","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1MQJPGNMijnXnVoBENFz9rUhaPt3S7rWoz","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1MQJPGNMijnXnVoBENFz9rUhaPt3S7rWoz","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1MQJPGNMijnXnVoBENFz9rUhaPt3S7rWoz","cycle":160,"change":"2000000"}],"delegate":"tz1MQJPGNMijnXnVoBENFz9rUhaPt3S7rWoz","slots":[11]}}],"signature":"sigqATJCs6kGB4nQcFDi3qKyzCVCsgUahUiRgUy1VvW3c6DYso61o5foQgrUs1uimsDKnraf8JaKAdTywb1MwNh9jZDxf1zr"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"onm1Vb3EfuG2AV65iy2AM8kuGzwCztSJJyd1nUHT8gA7Xtjc2yq","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1PesW5khQNhy4revu2ETvMtWPtuVyH2XkZ","change":"-128000000"},{"kind":"freezer","category":"deposits","delegate":"tz1PesW5khQNhy4revu2ETvMtWPtuVyH2XkZ","cycle":160,"change":"128000000"},{"kind":"freezer","category":"rewards","delegate":"tz1PesW5khQNhy4revu2ETvMtWPtuVyH2XkZ","cycle":160,"change":"4000000"}],"delegate":"tz1PesW5khQNhy4revu2ETvMtWPtuVyH2XkZ","slots":[8,6]}}],"signature":"sigiigy2hCsCc4mNfMVcCCM6iTVx91e3gSZwLct9umXT78ePLcS3KK7daAWJV7DTt4W3DqjoaDNMGueV6Nrv2uspw4u2f9q1"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"ooBotaGjECaK2zsRvp5XJRQDvuG6VAVdoFMpp3vz7CK8sbPNnzP","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz3RDC3Jdn4j15J7bBHZd29EUee9gVB1CxD9","change":"-128000000"},{"kind":"freezer","category":"deposits","delegate":"tz3RDC3Jdn4j15J7bBHZd29EUee9gVB1CxD9","cycle":160,"change":"128000000"},{"kind":"freezer","category":"rewards","delegate":"tz3RDC3Jdn4j15J7bBHZd29EUee9gVB1CxD9","cycle":160,"change":"4000000"}],"delegate":"tz3RDC3Jdn4j15J7bBHZd29EUee9gVB1CxD9","slots":[16,1]}}],"signature":"sigu7AH5eBchsQJKy5TEn5dpyqsCtMD1fcAvUKPsHR8J55UpAeAkphkp8ArZ4YsxoTWoxD73LuVwxfbwt2MzJrzVZYvEPAgy"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"onn9oJuTL3kDeyJTJLJvwS6tHZCW45pWGTjKS1Z3V8F6FP9LDMG","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz2TSvNTh2epDMhZHrw73nV9piBX7kLZ9K9m","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz2TSvNTh2epDMhZHrw73nV9piBX7kLZ9K9m","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz2TSvNTh2epDMhZHrw73nV9piBX7kLZ9K9m","cycle":160,"change":"2000000"}],"delegate":"tz2TSvNTh2epDMhZHrw73nV9piBX7kLZ9K9m","slots":[17]}}],"signature":"sigXBRHgYUWmiWV3rjUev9ya1KKUwcfcSAZXFsvJGrNt1uyJzLVrBrLN3yArbYEaMvs6GQeG1bQ2SCSfqJxE6XjDMBPHMwc5"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"oot71v2BWHkY4u6YbBSnxKr8yrSC91Timx4dVULCjQ1ozBNoq2q","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz3NExpXn9aPNZPorRE4SdjJ2RGrfbJgMAaV","change":"-192000000"},{"kind":"freezer","category":"deposits","delegate":"tz3NExpXn9aPNZPorRE4SdjJ2RGrfbJgMAaV","cycle":160,"change":"192000000"},{"kind":"freezer","category":"rewards","delegate":"tz3NExpXn9aPNZPorRE4SdjJ2RGrfbJgMAaV","cycle":160,"change":"6000000"}],"delegate":"tz3NExpXn9aPNZPorRE4SdjJ2RGrfbJgMAaV","slots":[27,21,3]}}],"signature":"sigYdXJzgfzi3dvoako4yZRMynMhfHVFuZqgTEGRFUcYH8DNcPexNCWQu68YGaZvTmFUkdZgvULFUzPKJwBr3TBVn8PcjELo"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"ooGN3KRyHG2GN9k2ErGkVXwPEkTbsHCvz1kVAoMTKfiVGnKD3df","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1LLNkQK4UQV6QcFShiXJ2vT2ELw449MzAA","change":"-64000000"},{"kind":"freezer","category":"deposits","delegate":"tz1LLNkQK4UQV6QcFShiXJ2vT2ELw449MzAA","cycle":160,"change":"64000000"},{"kind":"freezer","category":"rewards","delegate":"tz1LLNkQK4UQV6QcFShiXJ2vT2ELw449MzAA","cycle":160,"change":"2000000"}],"delegate":"tz1LLNkQK4UQV6QcFShiXJ2vT2ELw449MzAA","slots":[13]}}],"signature":"sigbzN2P5g68V5e5zJYgK9GiNVc3YS3BVk7G7STYKJubXPMbxoSKcQVeDLZVqCUFrhX4bxh6K2uB9N2Cv4T5AoUXUvumuNsr"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"onoYsU5KsEG52Kg3D2JDpRBhQkcrr1jj3B9TMb33bf122Dvh7Kp","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1TRqbYbUf2GyrjErf3hBzgBJPzW8y36qEs","change":"-128000000"},{"kind":"freezer","category":"deposits","delegate":"tz1TRqbYbUf2GyrjErf3hBzgBJPzW8y36qEs","cycle":160,"change":"128000000"},{"kind":"freezer","category":"rewards","delegate":"tz1TRqbYbUf2GyrjErf3hBzgBJPzW8y36qEs","cycle":160,"change":"4000000"}],"delegate":"tz1TRqbYbUf2GyrjErf3hBzgBJPzW8y36qEs","slots":[24,23]}}],"signature":"sighrXoa64SrCaF8NEFwY6Y43MymnnhCng3z4tVKEtiBstPeEb5wvpGSSrSLFSqTyWqhJegwrtPfUdUBwmco3fYHFSt1T1pp"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"ooREyyvfhsERYDXJ7j5sAJDSrzejCk43WpfrbS4WFvPYqQ8cuEc","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"endorsement","level":656938,"metadata":{"balance_updates":[{"kind":"contract","contract":"tz1eEnQhbwf6trb8Q8mPb2RaPkNk2rN7BKi8","change":"-192000000"},{"kind":"freezer","category":"deposits","delegate":"tz1eEnQhbwf6trb8Q8mPb2RaPkNk2rN7BKi8","cycle":160,"change":"192000000"},{"kind":"freezer","category":"rewards","delegate":"tz1eEnQhbwf6trb8Q8mPb2RaPkNk2rN7BKi8","cycle":160,"change":"6000000"}],"delegate":"tz1eEnQhbwf6trb8Q8mPb2RaPkNk2rN7BKi8","slots":[26,19,2]}}],"signature":"sigPS31652DcdLKvjKq4q2s3YYZjgztBjQDbrL2qpMpm21CP5QRUzbc23vdQPV1QtSNVGPhVM8BrgknrnxKAR5YabQfdqmdA"}],[],[],[{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"ooGypsBLe5Rk3zWVWj67JBYwwCxFTAWhM1YuAvN94K9oGP1Xeyz","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"transaction","source":"tz1SUgyRB8T5jXgXAwS33pgRHAKrafyg87Yc","fee":"12700","counter":"4984","gas_limit":"10307","storage_limit":"0","amount":"601000000","destination":"tz1W3HW533csCBLor4NPtU79R2TT2sbKfJDH","metadata":{"balance_updates":[{"kind":"contract","contract":"tz1SUgyRB8T5jXgXAwS33pgRHAKrafyg87Yc","change":"-12700"},{"kind":"freezer","category":"fees","delegate":"tz3WMqdzXqRWXwyvj5Hp2H7QEepaUuS7vd9K","cycle":160,"change":"12700"}],"operation_result":{"status":"applied","balance_updates":[{"kind":"contract","contract":"tz1SUgyRB8T5jXgXAwS33pgRHAKrafyg87Yc","change":"-601000000"},{"kind":"contract","contract":"tz1W3HW533csCBLor4NPtU79R2TT2sbKfJDH","change":"601000000"}],"consumed_gas":"10207"}}}],"signature":"sigdRJMJR2PntGv93EStrDmywwTH1y6eyEGnuBqV8CD3mxhar3tijXwTJFRQ23Dow8wDuiVrGJeAB2MCso6sMRU8ASBmGr78"},{"protocol":"PsBabyM1eUXZseaJdmXFApDSBqj8YBfwELoxZHHW77EMcAbbwAS","chain_id":"NetXdQprcVkpaWU","hash":"onyxb5CSqYoosmYtQzhAy2nw5164PTJqGEjMZ7PH4n8yDQmKLrn","branch":"BLtsAJFK9gSbhiUcAeA4aKfDZXADYCQTHoqgcP1nL3JBCypNAE1","contents":[{"kind":"transaction","source":"tz1MnyYPixeTxv339nNotoHzgXhBTG7ERHqE","fee":"5000","counter":"2156617","gas_limit":"18000","storage_limit":"257","amount":"1209000","destination":"KT1MFnMZGpC13cEZP51X2YaBi13Htf4MeRai","metadata":{"balance_updates":[{"kind":"contract","contract":"tz1MnyYPixeTxv339nNotoHzgXhBTG7ERHqE","change":"-5000"},{"kind":"freezer","category":"fees","delegate":"tz3WMqdzXqRWXwyvj5Hp2H7QEepaUuS7vd9K","cycle":160,"change":"5000"}],"operation_result":{"status":"applied","storage":{"bytes":"006c8fa9f196d1f2c7f2956c04d022b20461b15520"},"balance_updates":[{"kind":"contract","contract":"tz1MnyYPixeTxv339nNotoHzgXhBTG7ERHqE","change":"-1209000"},{"kind":"contract","contract":"KT1MFnMZGpC13cEZP51X2YaBi13Htf4MeRai","change":"1209000"}],"consumed_gas":"15285","storage_size":"232"}}}],"signature":"sighbifn5ebqWnMbs7yLC2getEskrDuqqyVa23vEGAYP8cArd6njyt2EVYiJznrgGH3qLr6bwvDgWyb8kFBXne2GFXqbQLm1"}]]}`)

var mockConstants = []byte(`{"proof_of_work_nonce_size":8,"nonce_length":32,"max_revelations_per_block":32,"max_operation_data_length":16384,"max_proposals_per_delegate":20,"preserved_cycles":5,"blocks_per_cycle":4096,"blocks_per_commitment":32,"blocks_per_roll_snapshot":256,"blocks_per_voting_period":32768,"time_between_blocks":["60","40"],"endorsers_per_block":32,"hard_gas_limit_per_operation":"800000","hard_gas_limit_per_block":"8000000","proof_of_work_threshold":"70368744177663","tokens_per_roll":"8000000000","michelson_maximum_type_size":1000,"seed_nonce_revelation_tip":"125000","origination_size":257,"block_security_deposit":"512000000","endorsement_security_deposit":"64000000","block_reward":"16000000","endorsement_reward":"2000000","cost_per_byte":"1000","hard_storage_limit_per_operation":"60000","test_chain_duration":"1966080","quorum_min":2000,"quorum_max":7000,"min_proposal_quorum":500,"initial_endorsers":24,"delay_per_missing_endorsement":"8"}`)

var mockCycle = []byte(`{"last_roll":[],"nonces":[],"random_seed":"04dca5c197fc2e18309b60844148c55fc7ccdbcb498bd57acd4ac29f16e22846","roll_snapshot":4}`)

// URL regexes for testing
var (
	regBlockURL     = regexp.MustCompile(`\/chains\/main\/blocks\/[A-z0-9]+`)
	regConstantsURL = regexp.MustCompile(`\/chains\/main\/blocks\/[A-z0-9]+\/context\/constants`)
	regCycleURL     = regexp.MustCompile(`\/chains\/main\/blocks\/[A-z0-9]+\/context\/raw\/json\/cycle\/[0-9]+`)
)
var blankHandler = http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {})

type blockMock struct {
	used bool
}

func (b *blockMock) handler(resp []byte, next http.Handler) http.Handler {
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		if regBlockURL.MatchString(r.URL.String()) && !b.used {
			w.Write(resp)
			b.used = true
			return
		}

		next.ServeHTTP(w, r)
	})
}

func constantsHandlerMock(resp []byte, next http.Handler) http.Handler {
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		if regConstantsURL.MatchString(r.URL.String()) {
			w.Write(resp)
			return
		}

		next.ServeHTTP(w, r)
	})
}

func cycleHandlerMock(resp []byte, next http.Handler) http.Handler {
	return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {
		if regCycleURL.MatchString(r.URL.String()) {
			w.Write(resp)
			return
		}

		next.ServeHTTP(w, r)
	})
}
